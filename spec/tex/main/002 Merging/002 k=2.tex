\section{Simple case : $k=2$}
\label{tree:merging:k=2}

\subsection{ITLB}
\label{tree:merging:k=2:ITLB}


\begin{theorem}
The ITLB for the merging problem when $k = 2$ with $|s_1| = m, |s_2| = n$ is \BigOmega{\log \binom{m+n}{m}}.
\end{theorem}

\begin{proof}
The length of the output sequence $s'$ is $m+n$. In order to zip $s_1$ and $s_2$ we have to choose the $m$ among $m+n$ positions in $s'$ for the elements of $s_1$ and then fill the remaining $(m+n) - m = n$ positions with the elements of $s_2$. The number of leaves of the decision tree is $\binom{m+n}{m}$ hence the worst minimal height of the tree is $log \binom{m+n}{m}$.
\end{proof}

\nb{Giving $log \binom{m+n}{m}$ in the form of the Stirling's approximation gives us $(m+n) \log(m+n) - m \log m - n \log n$ which clearly express the information contained in the sorted sequence $s'$ of $m+n$ elements minus the information we already have.}


\subsection{Algorithms}
\label{tree:merging:k=2:alg}

We consider the case where $m \leq n$. We build an algorithm $\in$ \BigO{\log \binom{m+n}{m}}.

\begin{lemma}
\begin{align*}
\log\binom{m+n}{m} &\leq m \log\frac{m+n}{m} + n \log\frac{m+n}{n}\\
\end{align*}
\end{lemma}

\begin{proof}
\begin{align*}
\log\binom{m+n}{m} &= \log\frac{(m+n)!}{m!n!}\\
&= \log(m+n)! - \log m! - \log n!\\
&\leq (m+n) \log(m+n) - m \log m - n \log n\\
&\leq (m+n) \log(m+n) - m \log m - n \log n + (n \log m - n \log m)\\
&\leq (m+n) \log(m+n) - (m+n) \log m - n (\log n - \log m)\\
&\leq (m+n) \log\frac{m+n}{m} - n (\log n - \log m)\\
&\leq m \log\frac{m+n}{m} + n \log\frac{m+n}{m} - n (\log n - \log m)\\
&\leq m \log\frac{m+n}{m} + n \log\frac{m+n}{\sfrac{m}{m} \cdot n}\\
&\leq m \log\frac{m+n}{m} + n \log\frac{m+n}{n}\\
\end{align*}
\end{proof}

\subsubsection{Case 1\texorpdfstring{ : $m = n$}{}}

\begin{lemma}
\begin{align*}
m = n &\implies \log\binom{m+n}{m} \leq m + n = 2m\\
\end{align*}
\end{lemma}

\begin{proof}
\begin{align*}
\log\binom{m+n}{m} &\leq m \log\frac{m+n}{m} + n \log\frac{m+n}{n}\\
&\leq m \log\frac{2m}{m} + n \log\frac{2n}{n}\\
&\leq m \log 2 + n \log 2\\
&\leq m + n\\
&\leq 2m\\
\end{align*}
\end{proof}

An algorithm performing \BigO{m} is Sequential Merge.

\subsubsection{Case 2\texorpdfstring{ : $m \ll n$}{}}

\begin{lemma}
\begin{align*}
m \ll n &\implies \log\binom{m+n}{m} \leq m \log\frac{n}{m}\\
\end{align*}
\end{lemma}

\begin{proof}
\begin{align*}
\log\binom{m+n}{m} &\leq m \log\frac{m+n}{m} + n \log\frac{m+n}{n}\\
&\leq m \log\frac{n}{m} + n \log\frac{n}{n}\\
&\leq m \log\frac{n}{m}\\
\end{align*}
\end{proof}

An algorithm performing \BigO{m \log\frac{n}{m}} is Two-Way Binary Search.


\subsubsection{Case 3\texorpdfstring{ : $m \ll n \land m = 1$}{}}

\begin{lemma}
\begin{align*}
m \ll n \land m = 1 &\implies \log\binom{m+n}{m} \leq \log n\\
\end{align*}
\end{lemma}

\begin{proof}
\begin{align*}
\log\binom{m+n}{m} &\leq m \log\frac{n}{m}\\
&\leq \log n\\
\end{align*}
\end{proof}

An algorithm performing \BigO{\log n} is Binary Search.

\subsubsection{Hwang-Lin}

From now on we have explored special cases, it would be nice if we could combine the disparate solutions to build an algorithm $\in$ \BigO{\log \binom{m+n}{m}} that works for any input.

The idea is that the algorithm should behave like :

\begin{itemize}
\item Sequential Merge in case $\frac{n}{m} = 1$
\item Two-Way Binary Search in case $m \ll n$
\item Binary Search in case $m \ll n \land m = 1$
\end{itemize}

Hwang and Lin give such an algorithm in \cite{DBLP:journals/siamcomp/HwangL72}.

The algorithm proceeds by reading sequentially every $\frac{n}{m}$ elements of $s_2$. Once the algorithm finds the interval of size $\frac{n}{m}$ where the first element of $s_1$ is to be found, it applies a binary search algorithm on this interval. We have the position of the first element.
We now want the position of the second element of $s_1$. The position of this second element is necessarily after the position we just found. Thus, if we proceed in the same manner for all the other elements of $s_1$ we will only iterate over the $m$ intervals once and will at most perform $m \log\frac{n}{m}$ comparisons inside the intervals, hence we get an algorithm $\in \BigO{ITLB + m - 1} \in \BigO{ITLB}$.

\nb{We can check that this algorithm matches the \concept{ITLB} found for our special cases.}